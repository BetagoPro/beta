<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" >
<head>
    <meta charset="UTF-8">
    <title>학습 그룹 조회</title>
    <!--공통으로 쓰이는 CSS 및  -->
    <div th:replace="~{common/fragments/config :: configFragment}"></div>
</head>
<style>
    .content_header{
    display: flex;
    padding: 22px;
    justify-content: space-around;
    align-items: flex-start;
}
.keyword-container{
    display: flex;
}
.edit-delete{
    display: flex;
    gap: 20px;
    position: relative;
    top: -2px;
}
.select-menu-group,
.select-menu-educator{
    width: auto;
    margin-right: 16px;
}
.select-menu-group .select-btn-group,
.select-menu-educator .select-btn-educator{
    display: flex;
    height: 40px;
    background: #fff;
    padding: 20px;
    font-size: 18px;
    font-weight: 400;
    border-radius: 8px;
    align-items: center;
    cursor: pointer;
    justify-content: space-between;
    box-shadow: 0 0 5px rgba(0,0,0,0.1);
}
.select-btn i{
    font-size: 25px;
    transition: 0.3s;
}
.select-menu-group.active .select-btn i,
.select-menu-educator.active .select-btn i{
    transform: rotate(-180deg);
}
.select-menu-group .options,
.select-menu-educator .options{
    position: absolute;
    padding: 10px;
    margin-top: 10px;
    width: 150px;
    border-radius: 8px;
    background: #fff;
    box-shadow: 0 0 3px rgba(0,0,0,0.1);
    display: none;
    transition: max-height 0.5s ease-in-out;
    z-index: 3;
}
.select-menu-group.active .options,
.select-menu-educator.active .options{
    display: block;
}
.options .option{
    display: flex;
    height: 45px;
    cursor: pointer;
    padding: 0 16px;
    border-radius: 8px;
    align-items: center;
    background: #fff;
}
.options .option:hover{
    background: #F3D973;
}
.option i{
    font-size: 25px;
    margin-right: 12px;
}
.option .option-text{
    font-size: 18px;
    color: #333;
}
.keyword-container h2{
    margin-right: 15px;
    line-height: 44px;
}
.select-menu-group .options,
.select-menu-educator .options {
    max-height: 0;
    overflow: hidden;
}

.select-menu-group.active .options,
.select-menu-educator.active .options {
    width: auto;
    z-index: 4;
    max-height: 200px;
    transition: max-height 0.2s ease-in-out;
    animation-name: slideDown;
    animation-duration: 0.2s;
}

@keyframes slideDown {
    from {
        max-height: 0;
    }
    to {
        max-height: 200px;
    }
}

.search-btn,.modify-btn,.delete-btn{
    height: 40px;
    background: #fff;
    padding: 20px;
    font-size: 18px;
    border: none;
    font-weight: 400;
    border-radius: 8px;
    line-height: 0;
    cursor: pointer;
    box-shadow: 0 0 5px rgba(0,0,0,0.1);
}
.search-btn:hover{
    background: #F4D96E;
}

    svg {
  overflow: hidden;
  vertical-align: middle; }
table {
  border-collapse: collapse; }
th {
  text-align: inherit; }


.table {
  min-width: 1000px !important;
  width: 100%;
  box-shadow: 0px 0px 13px 0px rgba(0, 0, 0, 0.29); }
  .table thead th {
    border: none;
    padding: 30px;
    font-size: 18px;
    font-weight: bold;
    color: black;
    text-align: center;
    }
  .table thead tr {
    background: #fff;
    border-bottom: 8px solid #eceffa; }
  .table tbody tr {
    margin-bottom: 10px;
        border-bottom: 6px solid #F1F1F1;
         }
    .table tbody tr:last-child {
      border-bottom: 0; }
  .table tbody td {
    border: none;
    padding: 30px;
    font-size: 14px;
    background: rgb(255 255 255 / 90%);
    vertical-align: middle;
    text-align: center;
    }

    .table tbody td.status span:after {
      position: absolute;
      top: 9px;
      left: 10px;
      width: 10px;
      height: 10px;
      content: '';
      border-radius: 50%; }

.close{
background: none;
    border: none;
}
.checkbox-wrap {
  display: block;
  position: relative;
  cursor: pointer;
  font-size: 16px;
  font-weight: 500;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none; }

.checkbox-wrap input {
  position: absolute;
  opacity: 0;
  cursor: pointer;
  height: 0;
  width: 0; }


.checkmark:after {
  content: "\f0c8";
  font-family: "FontAwesome";
  position: relative;
  color: rgba(0, 0, 0, 0.1);
  font-size: 25px;
  -webkit-transition: 0.3s;
  -o-transition: 0.3s;
  transition: 0.3s; }


.checkbox-wrap input:checked ~ .checkmark:after {
  display: block;
  content: "\f14a";
  font-family: "FontAwesome";
  color: rgba(0, 0, 0, 0.2); }

.checkbox-wrap {
  color: #40bfc1; }
  .checkbox-wrap input:checked ~ .checkmark:after {
    color: #40bfc1; }
.tbody-tr:hover {
background: #339fff;
}
    .detail-search{
    border: none;
    background: none;
    cursor: pointer;
    }
    .detail-search i{
     font-size: 27px;
    }
</style>
<script>
    //게임 콘텐츠 목록 리스트
    $(document).ready(function() {
        const groupMenu = document.querySelector(".select-menu-group");
        const selectGroupBtn = groupMenu.querySelector(".select-btn-group");
        const groupOptions = groupMenu.querySelectorAll(".option");
        const groupSBtnText = groupMenu.querySelector(".sBtn-text");

        selectGroupBtn.addEventListener("click", () => groupMenu.classList.toggle("active"));
        groupOptions.forEach(option => {
            option.addEventListener("click", () => {
                let selectedOption = option.querySelector(".option-text").innerText;
                groupSBtnText.innerText = selectedOption;
                groupMenu.classList.remove("active");
            });
        });
    });
    $(document).ready(function() {
    $(".delete-btn").click(function() {
        var selectCheck = []; // 선택된 체크박스의 data-check-no 값들을 저장할 배열
        console.log("클릭됨");
        // 선택된 체크박스를 찾아서 data-check-no 값을 배열에 추가
        $(".checkbox:checked").each(function() {
            var checkNo = $(this).attr("data-check-no");
            selectCheck.push(checkNo);
        });
            console.log(selectCheck);
        // AJAX 요청 보내기
        $.ajax({
            url: "/educator/group/delete",
            type: "POST",
            data: { group_no: selectCheck },
            dataType: "text",
            traditional: true,
            success: function(response) {
                if(response==="success"){
                console.log("삭제 요청이 성공적으로 처리되었습니다.");
                }else{
                console.log("삭제 실패");
                }

                console.log(response);
            },
            error: function(xhr, status, error) {
                console.error("삭제 요청 중 오류가 발생했습니다.");
                console.error(error);
            }
        });
    });
});
</script>
<body>
<div th:replace="~{common/fragments/header :: headerFragment}"></div>
<div class="content">
    <div th:replace="~{common/sidebar/edu_sidebar :: edu_sidebarFragment}"></div>
    <div class="content-wrap">
        <div class="content_header">
            <div class="keyword-container">
                <h2>학습 그룹</h2>
                <div class="select-menu-group">
                    <div class="select-btn-group">
                        <span class="sBtn-text">전체</span>
                        <i class="bx bx-chevron-down"></i>
                    </div>
                    <ul class="options">
                        <li class="option" th:each="groupName : ${groupName}">
                            <span class="option-text" th:text="${groupName.group_name}"></span>
                        </li>
                    </ul>
                </div>
                <button class="search-btn">조회</button>
            </div>
            <div class="edit-delete">
                <button type="button" class="modify-btn" value="학습 그룹 상세 입력">수정</button>
                <button type="button" class="delete-btn" value="학습 그룹 상세 입력">삭제</button>
            </div>
        </div>
        <section class="main-content">
            <div class="container" >
                <div class="table-wrap">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>&nbsp;</th>
                            <th>학습 그룹명</th>
                            <th>게임 콘텐츠명</th>
                            <th>그룹T/O</th>
                            <th>구독기간</th>
                            <th>등록 학생수</th>
                            <th>상세 조회</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr class="tbody-tr" th:each="groupList : ${groupList}">
                            <td>
                                <label class="checkbox-wrap">
                                    <input class="checkbox" type="checkbox" th:attr="data-check-no=${groupList.group_no}">
                                    <span class="checkmark"></span>
                                </label>
                            </td>
                            <td class="">
                                <div class="">
                                    <span th:text="${groupList.group_name}"></span>
                                </div>
                            </td>
                            <td>
                                <span th:text="${groupList.game_title}"></span>
                            </td>
                            <td class="status">
                                <span class="active" th:text="${groupList.group_cnt}-${groupList.group_nowcnt}"></span>
                            </td>
                            <td>
                                <span th:text="${groupList.group_enddate}"></span>
                            </td>
                            <td>
                                <span class="active" th:text="${groupList.group_nowcnt}"></span>
                            </td>
                            <td>
                                <button class="detail-search" th:attr="data-detail-no=${groupList.group_no}"><i class="ri-search-eye-line" data-tasksend_no=""></i></button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

    </div>
</div>
<div th:replace="~{common/fragments/footer :: footerFragment}"></div>
</body>
</html>