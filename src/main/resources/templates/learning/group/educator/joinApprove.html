<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>학습그룹 가입 승인</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/learning/group/educator/joinApprove.css}">
    <div th:replace="~{common/fragments/config :: configFragment}"></div>
</head>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // 모든 체크박스에 이벤트 리스너 추가
        document.querySelectorAll('.checkbox, .checkbox2').forEach(function(checkbox) {
            checkbox.addEventListener('change', function() {
                // 선택된 체크박스의 부모 노드 (tr) 찾기
                var row = this.closest('.tr-list');
                var approveCheckbox = row.querySelector('.checkbox');
                var rejectCheckbox = row.querySelector('.checkbox2');

                // 둘 다 선택되었는지 확인
                if (approveCheckbox.checked && rejectCheckbox.checked) {
                    alert('둘 중 하나만 체크가 가능합니다.');
                    // 현재 선택한 체크박스의 선택을 취소
                    this.checked = false;
                }
            });
        });
         $(document).ready(function() {
        const groupMenu = document.querySelector(".select-menu-group");
        const selectGroupBtn = groupMenu.querySelector(".select-btn-group");
        const groupOptions = groupMenu.querySelectorAll(".option");
        const groupSBtnText = groupMenu.querySelector(".sBtn-text");

        selectGroupBtn.addEventListener("click", () => groupMenu.classList.toggle("active"));
        groupOptions.forEach(option => {
            option.addEventListener("click", () => {
                let selectedOption = option.querySelector(".option-text").innerText;
                groupSBtnText.innerText = selectedOption;
                groupMenu.classList.remove("active");
            });
        });
    });
    });
</script>
<body>
<div th:replace="~{common/fragments/header :: headerFragment}"></div>
<div class="content">
    <div th:replace="~{common/sidebar/edu_sidebar :: edu_sidebarFragment}"></div>
    <div class="content-wrap">
        <div class="content-header">
            <div>
                <h3>학습 그룹</h3>
                <div class="select-menu-group">
                    <div class="select-btn-group">
                        <span class="sBtn-text">전체</span>
                        <i class="bx bx-chevron-down"></i>
                    </div>
                    <ul class="options">
                        <li class="option">
                            <span class="option-text">전체</span>
                        </li>
                        <li class="option" th:each="group_name : ${group_name}">
                            <span class="option-text" th:text="${group_name.group_name}"></span>
                        </li>
                    </ul>
                </div>
            </div>
            <div>
                <h3>구독 가능인원:<span>60명</span></h3>
            </div>
            <div>
                <h3>승인 인원:<span>30명</span></h3>
            </div>
        </div>
        <div class="main-table">
        <div class="table-wrap">
            <table >
                <caption class="table-title">그룹 가입신청 목록👀</caption>
                <thead class="table-head">
                <tr>
                    <th class="t_no">번호</th>
                    <th class="t_name">학생이름</th>
                    <th class="t_phone">학생 연락처</th>
                    <th class="t_date">승인 요청일자</th>
                    <th class="t_approve">승인</th>
                    <th class="t_reject">거부</th>
                </thead>
                <tbody class="tbody-container">
                <th:block th:if="${check == null}">
                    <tr>
                        <td colspan="6">그룹을 선택 후 조회 해주세요.</td>
                    </tr>
                </th:block>
                <th:block th:if="${groupNo != null and #lists.isEmpty(GroupPageDTO.groupList)}">
                    <tr>
                        <td colspan="6">가입 신청한 회원이 존재하지 않습니다.</td>
                    </tr>
                </th:block>
                <th:block th:if="${not #lists.isEmpty(GroupPageDTO.groupList)}">
                    <tr class="tr-list"  th:each="list, index : ${GroupPageDTO.groupList}">
                        <td class="list_no" th:text="${index.index + GroupPageDTO.startIndex + 1}"></td>
                        <td class="list_name" th:text="${list.member_name}"></td>
                        <td class="list_phone" th:text="${list.member_phone}"></td>
                        <td class="list_date" th:text="${list.approve_date}"></td>
                        <td class="list_approve" >
                            <label class="checkbox-wrap">
                                <input class="checkbox" type="checkbox" th:attr="data-approve-no=${list.member_no}">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td class="list_reject" >
                            <label class="checkbox-wrap2">
                                <input class="checkbox2" type="checkbox" th:attr="data-reject-no=${list.member_no}">
                                <span class="checkmark2"></span>
                            </label>
                        </td>
                    </tr>
                </th:block>
                </tbody>
            </table>
        </div>
        <th:block th:if="${check != null}">
        <div class="pagination">
            <div class="paging">
                <div class="text-center clearfix">
                    <div class="pagingNum">
                        <ul class="pagination-container" id="pagination">
                            <li th:if="${GroupPageDTO.startPage > 5}" class="page-item">
                                <a class="page-link" th:with="prevPage=${GroupPageDTO.startPage - 1}" th:href="@{/educator/group/approveList(page=${prevPage})}">Prev</a>
                            </li>
                            <li th:if="${pageNum > 0}" th:each="pageNum : ${#numbers.sequence(GroupPageDTO.startPage, GroupPageDTO.endPage)}" class="page-item">
                                <a th:href="@{/educator/group/approveList(page=${pageNum})}" class="page-link" th:classappend="${currentPage == pageNum} ? 'active-page' : ''"><span th:text="${pageNum}"></span></a>
                            </li>
                            <li th:if="${GroupPageDTO.endPage < GroupPageDTO.totalPages}" class="page-item">
                                <a class="page-link" th:with="nextPage=${GroupPageDTO.startPage + 5}" th:href="@{/educator/group/approveList(page=${nextPage})}">Next</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        </th:block>
        </div>
    </div>
</div>
<div th:replace="~{common/fragments/footer :: footerFragment}"></div>
</body>
</html>
