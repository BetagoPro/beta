<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bnw.beta.domain.admin.dao.GameDAO">
<!--게임콘텐츠 모든 목록 조회-->
    <select id="selectAll" resultType="GameDTO">
        <![CDATA[
        SELECT *
        FROM game;
        ]]>
    </select>
    <!--게임콘텐츠 등록-->
    <insert  id="insertGame" parameterType="GameDTO">
            <![CDATA[
                insert into game (game_title, game_level, game_date, game_total,
                game_price, game_discount, game_sell, game_content, member_id)
                values (#{game_title}, #{game_level}, #{game_date}, #{game_total}
                , #{game_price}, #{game_discount}, #{game_sell}, #{game_content}, #{member_id});
                ]]>
    </insert>
    <!--월간 (일일 단위 매출조회)-->
   <select id="selectDailySales" resultType="SalesDTO">
        <![CDATA[
            select DATE_FORMAT(pay_date, '%Y-%m-%d') AS date, sales_count, SUM(sales_count * game_sell) AS sales_amount
            from sales s
            join game g ON s.game_no = g.game_no
            where pay_date between #{sales_startsearch} and #{sales_endsearch}
            group by DATE_FORMAT(pay_date, '%Y-%m-%d')
            order by DATE_FORMAT(pay_date, '%Y-%m-%d') desc;
        ]]>
   </select>
    <!--년간 (월 단위 매출조회)-->
    <select id="selectMonthlySales" resultType="SalesDTO">
        <![CDATA[
            select DATE_FORMAT(pay_date, '%Y-%m') AS date, sales_count, SUM(sales_count * game_sell) AS sales_amount
            from sales s
            where pay_date between #{sales_startsearch} and #{sales_endsearch}
            group by DATE_FORMAT(pay_date, '%Y-%m')
            order by DATE_FORMAT(pay_date, '%Y-%m') desc;
        ]]>
    </select>
<!--게임콘텐츠 제목 검색-->
    <select id="searchByTitle" resultType="GameDTO">
        <![CDATA[
            select *
            from game
            where game_title = #{game_title}
        ]]>
    </select>


</mapper>


